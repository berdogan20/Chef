{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport { v4 as uuidv4 } from 'uuid';\nlet BuyFoodComponent = class BuyFoodComponent {\n  constructor(route, router, authService, foodService, orderService, categoryService, userService, fb) {\n    this.route = route;\n    this.router = router;\n    this.authService = authService;\n    this.foodService = foodService;\n    this.orderService = orderService;\n    this.categoryService = categoryService;\n    this.userService = userService;\n    this.fb = fb;\n    this.foodId = 'not loaded';\n    this.food = {};\n    this.category = \"\";\n    this.form = this.fb.group({\n      number: [1, Validators.compose([Validators.required, Validators.min(1), Validators.max(10)])]\n    });\n    this.findFood = foodId => {\n      this.foodId = foodId ?? 'not passed';\n      this.foodService.findFood({\n        id: this.foodId\n      }).subscribe(food => {\n        this.food = food;\n        this.getCategory(this.food.categoryId);\n      }, err => this.handleError(err));\n    };\n    this.handleError = err => {\n      if (err.status == 404) {\n        alert(\"Food not found!\");\n        this.router.navigate(['/menu']);\n      }\n      if (err.status == 409) {\n        console.log(\"err: \" + err);\n        alert(JSON.parse(err.error).message);\n      }\n      console.log(\"Response Error. Status: \", err.status);\n      console.log(\"Response Error. Status Text: \", err.statusText);\n      console.log(err);\n    };\n  }\n  ngOnInit() {\n    this.route.paramMap.subscribe(p => this.findFood(p.get(\"foodId\")));\n  }\n  addToBasket() {\n    if (this.form.invalid) return;\n    const orderItem = {\n      amount: this.form.get('number')?.value,\n      orderItemId: uuidv4(),\n      foodItemName: this.food.name,\n      price: this.food.price\n    };\n    console.log(orderItem);\n    this.userService;\n  }\n  get number() {\n    return this.form.controls.number;\n  }\n  getCategory(id) {\n    this.categoryService.findCategory({\n      id: id\n    }).subscribe(rm => this.category = rm.name, err => this.handleError(err));\n  }\n};\nBuyFoodComponent = __decorate([Component({\n  selector: 'app-buy-food',\n  templateUrl: './buy-food.component.html',\n  styleUrls: ['./buy-food.component.css']\n})], BuyFoodComponent);\nexport { BuyFoodComponent };","map":{"version":3,"mappings":"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","names":["Component","Validators","v4","uuidv4","BuyFoodComponent","constructor","route","router","authService","foodService","orderService","categoryService","userService","fb","group","number","compose","required","min","max","foodId","findFood","id","subscribe","food","getCategory","categoryId","err","handleError","status","alert","navigate","console","log","JSON","parse","error","message","statusText","ngOnInit","paramMap","p","get","addToBasket","form","invalid","orderItem","amount","value","orderItemId","foodItemName","name","price","controls","findCategory","rm","category","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["/Users/beyzaerdogan/Desktop/Chef/Chef/ClientApp/src/app/buy-food/buy-food.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { CategoryService, FoodService, OrderService } from '../api/services';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { FoodRm, OrderDto, OrderItem } from '../api/models';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { AuthService } from '../auth/auth.service';\nimport { v4 as uuidv4 } from 'uuid';\n\n\n@Component({\n  selector: 'app-buy-food',\n  templateUrl: './buy-food.component.html',\n  styleUrls: ['./buy-food.component.css']\n})\nexport class BuyFoodComponent {\n\n  foodId: string = 'not loaded';\n  food: FoodRm = {};\n  category: string = \"\";\n\n\n  constructor(private route: ActivatedRoute,\n    private router: Router,\n    private authService: AuthService,\n    private foodService: FoodService,\n    private orderService: OrderService,\n    private categoryService: CategoryService,\n    private userService: UserService,\n    private fb: FormBuilder  ) { }\n\n\n  form = this.fb.group({\n    number: [1, Validators.compose([Validators.required, Validators.min(1), Validators.max(10)])]\n  })\n\n  ngOnInit(): void {\n    this.route.paramMap\n      .subscribe(p => this.findFood(p.get(\"foodId\")))\n  }\n\n  private findFood = (foodId: string | null) => {\n    this.foodId = foodId ?? 'not passed';\n\n    this.foodService.findFood({ id: this.foodId })\n      .subscribe(\n        food => {\n          this.food = food\n          this.getCategory(this.food.categoryId!);\n        },\n        err => this.handleError(err)\n      );\n   }\n\n  private handleError = (err: any) => {\n\n    if (err.status == 404) {\n      alert(\"Food not found!\")\n      this.router.navigate(['/menu'])\n    }\n\n\n    if (err.status == 409) {\n      console.log(\"err: \" + err);\n      alert(JSON.parse(err.error).message)\n    }\n\n    console.log(\"Response Error. Status: \", err.status)\n    console.log(\"Response Error. Status Text: \", err.statusText)\n    console.log(err)\n  }\n\n  addToBasket() {\n\n    if (this.form.invalid)\n      return;\n\n\n    const orderItem: OrderItem = {\n      amount: this.form.get('number')?.value!,\n      orderItemId: uuidv4(),\n      foodItemName: this.food.name,\n      price: this.food.price\n    }\n\n    console.log(orderItem);\n\n    this.userService\n\n  \n  }\n\n  get number() {\n    return this.form.controls.number\n  }\n\n  getCategory(id: number) {\n    this.categoryService.findCategory({ id: id })\n      .subscribe(rm => this.category = rm.name!,\n        err => this.handleError(err));\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}